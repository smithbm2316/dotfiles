# vim: filetype=i3config

# -------------------------------------------------- VARIABLES
set $mod Mod4
set $alt Mod1
set $left h
set $down j
set $up k
set $right l
floating_modifier $mod
set $term kitty
set $primary_display HDMI-0
set $alt_display eDP-1-1

# -------------------------------------------------- THEME
set $bgFocused #232126
set $bgUnfocused #312f44
set $textFocused #e0def4
set $textUnfocused #817c9c 
set $borderFocused #3e8fb0
set $borderUnfocused #312f44
set $borderUrgent #eb6f92
set $bgUrgent #eb6f92
set $textUrgent #eb6f92
set $indicatorFocused #c4a7e7
set $textInactiveWorkspace #9ccfd8
set $barSeparator #ea9a97
set $powderBlue #3e8fb0
set $oldLavender #817c9c
font pango:BlexMono Nerd Font Mono:style=Medium 12

# -------------------------------------------------- POWER OPTIONS
#i3help restart i3 inplace
bindsym $mod+ctrl+r restart, mode "default"

# -------------------------------------------------- SWITCH FOCUS
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right

# -------------------------------------------------- MOVE WINDOW IN STACK
bindsym $mod+ctrl+$left move left
bindsym $mod+ctrl+$down move down
bindsym $mod+ctrl+$up move up
bindsym $mod+ctrl+$right move right

# -------------------------------------------------- LAYOUT KEYBINDINGS
bindsym $mod+v split h
bindsym $mod+s split v
# Fullscreen
bindsym $mod+f fullscreen toggle
popup_during_fullscreen smart

bindsym $mod+ctrl+s sticky toggle
# cycle layouts
bindsym $mod+w layout toggle splith tabbed
bindsym $mod+ctrl+f floating toggle
# swap focus between floating and non-floating windows
bindsym $mod+space focus mode_toggle
# focus urgent
bindsym $mod+u [urgent="latest"] focus
# focus parent
bindsym $mod+p focus parent
# focus young one (child)
bindsym $mod+y focus child

# -------------------------------------------------- WORKSPACE MOVEMENT
bindsym $mod+ctrl+m move workspace to output left
bindsym $mod+m focus output left
bindsym $mod+a workspace back_and_forth
bindsym $mod+semicolon workspace next
bindsym $mod+comma workspace prev
bindsym $mod+ctrl+semicolon move container to workspace next, workspace next, mode "default"
bindsym $mod+ctrl+comma move container to workspace prev, workspace prev, mode "default"

# -------------------------------------------------- PULSEAUDIO CONTROLS
bindsym XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%
bindsym XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
bindsym $mod+XF86AudioMute exec pactl set-sink-volume @DEFAULT_SINK@ 50%
bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioPrev exec playerctl previous
bindsym XF86AudioNext exec playerctl next
bindsym $mod+F11 exec xrandr --output $alt_display --brightness 0.6
bindsym $mod+F12 exec xrandr --output $alt_display --brightness 1.0
bindsym $mod+ctrl+a exec ~/dotfiles/scripts/airpods.sh

# -------------------------------------------------- WORKSPACES
set $wsMisc "0:misc"
set $wsDev "1:dev"
set $wsWeb "2:web"
set $wsMessages "3:messages"
set $wsVibes "4:vibes"
set $wsNotes "5:notes"

# -------------------------------------------------- WORKSPACE RESTRICTIONS
workspace_layout tabbed
workspace $wsMisc output $alt_display
workspace $wsWeb output $primary_display
workspace $wsDev output $primary_display
workspace $wsMessages output $primary_display
workspace $wsVibes output $primary_display

# -------------------------------------------------- SWITCH TO WORKSPACE
bindsym $mod+0 workspace $wsMisc, mode "default"
bindsym $mod+1 workspace $wsDev, mode "default"
bindsym $mod+2 workspace $wsWeb, mode "default"
bindsym $mod+3 workspace $wsMessages, mode "default"
bindsym $mod+4 workspace $wsVibes, mode "default"
bindsym $mod+5 workspace $wsNotes, mode "default"

# -------------------------------------------------- MOVE WINDOW TO WORKSPACE
bindsym $mod+ctrl+0 move container to workspace $wsMisc, workspace $wsMisc, mode "default"
bindsym $mod+ctrl+1 move container to workspace $wsDev, workspace $wsDev, mode "default"
bindsym $mod+ctrl+2 move container to workspace $wsWeb, workspace $wsWeb, mode "default"
bindsym $mod+ctrl+3 move container to workspace $wsMessages, workspace $wsMessages, mode "default"
bindsym $mod+ctrl+4 move container to workspace $wsVibes, workspace $wsVibes, mode "default"
bindsym $mod+ctrl+5 move container to workspace $wsNotes, workspace $wsNotes, mode "default"

bindsym $mod+shift+0 move container to workspace $wsMisc, mode "default"
bindsym $mod+shift+1 move container to workspace $wsDev, mode "default"
bindsym $mod+shift+2 move container to workspace $wsWeb, mode "default"
bindsym $mod+shift+3 move container to workspace $wsMessages, mode "default"
bindsym $mod+shift+4 move container to workspace $wsVibes, mode "default"
bindsym $mod+shift+5 move container to workspace $wsNotes, mode "default"

# -------------------------------------------------- MISCELLANEOUS KEYBINDS
# Focus follows the mouse!
focus_follows_mouse no
mouse_warping output
# When launching a new app, focus should go to it
focus_on_window_activation focus
#i3help start a terminal
bindsym $mod+t exec $term
# kill focused window
bindsym $mod+c kill
#i3help Rofi application launcher
bindsym $mod+o exec --no-startup-id ~/dotfiles/rofi/rofi.sh drun
#i3help Rofi cli program launcher
bindsym $mod+q exec --no-startup-id ~/dotfiles/rofi/rofi.sh powermenu
#i3help Rofi run program
bindsym $mod+ctrl+o exec --no-startup-id ~/dotfiles/rofi/rofi.sh run
#i3help Rofi open windows
bindsym $alt+Tab exec --no-startup-id ~/dotfiles/rofi/rofi.sh window
#i3help Rofi calculator with qalc
bindsym $mod+g exec --no-startup-id ~/dotfiles/rofi/rofi.sh calc
#i3help Rofi Emoji picker
bindsym $mod+ctrl+e exec --no-startup-id ~/dotfiles/rofi/rofi.sh emoji
# Screenshot
bindsym Print exec flameshot gui -c -s
bindsym ctrl+Print exec flameshot gui
bindsym $mod+Print exec flameshot screen --clipboard

# -------------------------------------------------- RESIZE MODE
mode "resize" {
  # These bindings trigger as soon as you enter the resize mode

  #i3help h shrinks width
  bindsym $left resize shrink width 5 px or 5 ppt
  #i3help j grows height
  bindsym $down resize grow height 5 px or 5 ppt
  #i3help k grows height
  bindsym $up resize shrink height 5 px or 5 ppt
  #i3help right grows width
  bindsym $right resize grow width 5 px or 5 ppt

  #i3help leave resize mode
  bindsym Return mode "default"
  #i3help leave resize mode
  bindsym Escape mode "default"
}

#i3help enter resize mode
bindsym $mod+r mode "resize"

# -------------------------------------------------- WINDOW COLORS
# property name, border, background, text, indicator
client.focused          $borderFocused $bgFocused $textFocused $indicatorFocused $borderFocused
client.unfocused        $borderUnfocused $bgUnfocused $textUnfocused $bgUnfocused $borderUnfocused
client.focused_inactive $borderUnfocused $bgUnfocused $textUnfocused $bgUnfocused $borderUnfocused
client.urgent           $borderUrgent $bgUrgent $textUrgent $textUrgent $borderUrgent
client.placeholder      $borderUnfocused $bgUnfocused $textUnfocused $barSeparator $borderUnfocused
client.background       $bgUnfocused

#i3 window colors
default_border pixel 2
default_floating_border pixel 4

# -------------------------------------------------- SCRATCHPAD
bindsym $mod+ctrl+t [class=$term title="^scratchpad$"] scratchpad show
bindsym $mod+shift+t exec $term --title "scratchpad"

# -------------------------------------------------- DEFAULT WORKSPACES
# Dev
assign [class="^brave-browser$"] $wsDev
assign [class="^Brave-browser$"] $wsDev
# Web
assign [class="^firefox$"] $wsWeb
# Messaging
assign [class="^slack$"] $wsMessages 
assign [class="^Slack$"] $wsMessages 
assign [class="^discord$"] $wsMessages 
# Vibes
# Spotify is annoying and doesn't work with regular "assign"
for_window [class="^Spotify$"] move to workspace $wsVibes
assign [class="^ncspot$"] $wsVibes
assign [title="^ncspot$"] $wsVibes
assign [class="^obs$"] $wsVibes
# Notes
assign [class="^obsidian$"] $wsNotes 

# -------------------------------------------------- APP EXCEPTIONS
# Zoom meetings
for_window [class="zoom\s?"] floating enable, resize set 800 600, move position center
for_window [class="^blueman-manager$"] floating enable, resize set 800 600, move position center
for_window [class="^Blueman-manager$"] floating enable, resize set 800 600, move position center
# terminal scratchpad
for_window [class=$term title="^scratchpad$"] floating enable, resize set 800 600, move position center, move scratchpad

# -------------------------------------------------- AUTOSTART
exec ~/dotfiles/config/vincit.sh
exec picom
# exec nitrogen --restore
exec xsetroot -cursor_name left_ptr
exec xset r rate 250 25 &
exec bluetoothctl disconnect E8:85:4B:4A:82:86; bluetoothctl block E8:85:4B:4A:82:86 &
exec dunst
exec flameshot
exec nm-applet
exec blueman-applet
exec_always --no-startup-id $HOME/dotfiles/polybar/launch.sh

# start up scratchpad instances
exec --no-startup-id kitty --title "scratchpad"

# programs to use on startup
# exec --no-startup-id i3-msg workspace $wsDev; exec kitty
# exec --no-startup-id i3-msg workspace $wsDev; exec brave-browser
# exec --no-startup-id i3-msg workspace $wsWeb; exec firefox
# exec --no-startup-id i3-msg workspace $wsMessages; exec slack
# exec --no-startup-id i3-msg workspace $wsVibes; exec spotify
exec --no-startup-id i3-msg workspace $wsDev; exec 1password
