# i3 config file (v4)
# Please see https://i3wm.org/docs/userguide.html for a complete reference!

# -------------------------------------------------- VARIABLES
set $mod Mod4
set $alt Mod1
set $left h
set $down j
set $up k
set $right l
floating_modifier $mod

# -------------------------------------------------- THEME
set $bgFocused #27212e
set $bgUnfocused #382f47
set $textFocused #ffffff
set $textUnfocused #716385
set $borderFocused #eb64b9
set $borderUnfocused #382f47
set $borderUrgent #ffe261
set $bgUrgent #ffe261
set $textUrgent #ffe261
set $indicatorFocused #b381c5
set $textInactiveWorkspace #74dfc4
set $barSeparator #40b4c4
set $powderBlue #b4dce7
set $oldLavender #91889b
font pango:Ubuntu Nerd Font 14

# -------------------------------------------------- POWER OPTIONS
bindsym $mod+q mode "$mode_system"
set $mode_system (l)ock, (e)xit, (s)uspend, (r)eboot, (p)ower down, (c)onfig, (r)estart
mode "$mode_system" {
  bindsym l exec --no-startup-id i3lock -c "#382f47" -i "/home/smithbm/Pictures/retrowave-landscape/retrowave1.png", mode "default"
  bindsym s exec --no-startup-id i3lock -c "#382f47" -i "/home/smithbm/Pictures/retrowave-landscape/retrowave1.png" && systemctl suspend, mode "default"
  bindsym e exec i3-msg exit, mode "default"
  bindsym ctrl+r exec reboot, mode "default"
  bindsym p exec shutdown 1, mode "default"
  #i3help reload the configuration file
  bindsym c reload, mode "default"
  #i3help restart i3 inplace
  bindsym r restart, mode "default"

  # exit system mode: "Enter" or "Escape"
  bindsym Return mode "default"
  bindsym Escape mode "default"
}

# -------------------------------------------------- SWITCH FOCUS
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right

# -------------------------------------------------- MOVE WINDOW IN STACK
bindsym $mod+ctrl+$left move left
bindsym $mod+ctrl+$down move down
bindsym $mod+ctrl+$up move up
bindsym $mod+ctrl+$right move right

# -------------------------------------------------- LAYOUT KEYBINDINGS
bindsym $mod+v split h
bindsym $mod+s split v
# Fullscreen
bindsym $mod+f fullscreen toggle
popup_during_fullscreen smart

bindsym $mod+Control+s sticky toggle
# cycle layouts
bindsym $mod+w layout toggle splith tabbed
bindsym $mod+z floating toggle
# swap focus between floating and non-floating windows
bindsym $mod+space focus mode_toggle
# focus urgent
bindsym $mod+u [urgent="latest"] focus
# focus adult (parent)
bindsym $mod+a focus parent
# focus young one (child)
bindsym $mod+y focus child

# -------------------------------------------------- WORKSPACE MOVEMENT
bindsym $mod+ctrl+n move workspace to output up
bindsym $mod+n focus output up
bindsym $mod+p workspace back_and_forth

# -------------------------------------------------- PULSEAUDIO CONTROLS
bindsym XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%
bindsym XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioPrev exec playerctl previous
bindsym XF86AudioNext exec playerctl next

# -------------------------------------------------- WORKSPACES
set $wsDev "1:dev"
set $wsWeb "2:web"
set $wsShare "3:share"
set $wsVibes "4:vibes"
set $wsMessages "5:messages"
set $wsTasks "6:tasks"
set $wsUCI "7:uci"
set $wsApp "8:app"
set $wsID "9:id"
set $wsHax "10:hax"
set $wsEmail "11:email"
set $wsNotes "12:notes"

# -------------------------------------------------- WORKSPACE RESTRICTIONS
workspace $wsVibes output HDMI-A-0
workspace $wsMessages output HDMI-A-0
workspace $wsID output HDMI-A-0
workspace $wsApp output HDMI-A-0
workspace $wsWeb output DisplayPort-0
workspace $wsDev output DisplayPort-0
workspace $wsTasks output DisplayPort-0
workspace $wsEmail output DisplayPort-0

# -------------------------------------------------- SWITCH TO WORKSPACE
set $chooseWorkspace go to: (d)ev/(w)eb/(s)hare/(v)ibes/(m)essages/(t)asks/(u)ci/(a)pp/(i)d/(h)ax
bindsym $mod+g mode "$chooseWorkspace"
mode "$chooseWorkspace" {
  bindsym d workspace $wsDev, mode "default"
  bindsym w workspace $wsWeb, mode "default"
  bindsym s workspace $wsShare, mode "default"
  bindsym v workspace $wsVibes, mode "default"
  bindsym m workspace $wsMessages, mode "default"
  bindsym t workspace $wsTasks, mode "default"
  bindsym u workspace $wsUCI, mode "default"
  bindsym a workspace $wsApp, mode "default"
  bindsym i workspace $wsID, mode "default"
  bindsym h workspace $wsHax, mode "default"
  bindsym e workspace $wsEmail, mode "default"
  bindsym n workspace $wsNotes, mode "default"

  # exit system mode: "Enter" or "Escape"
  bindsym Return mode "default"
  bindsym Escape mode "default"
}

# -------------------------------------------------- MOVE WINDOW TO WORKSPACE
set $moveToWorkspace move to: (d)ev/(w)eb/(s)hare/(v)ibes/(m)essages/(t)asks/(u)ci/(a)pp/(i)d/(h)ax
bindsym $mod+m mode "$moveToWorkspace"
mode "$moveToWorkspace" {
  # move to workspace but don't follow window
  bindsym Shift+d move container to workspace $wsDev, mode "default"
  bindsym Shift+w move container to workspace $wsWeb, mode "default"
  bindsym Shift+s move container to workspace $wsShare, mode "default"
  bindsym Shift+v move container to workspace $wsVibes, mode "default"
  bindsym Shift+m move container to workspace $wsMessages, mode "default"
  bindsym Shift+t move container to workspace $wsTasks, mode "default"
  bindsym Shift+u move container to workspace $wsUCI, mode "default"
  bindsym Shift+a move container to workspace $wsApp, mode "default"
  bindsym Shift+i move container to workspace $wsID, mode "default"
  bindsym Shift+h move container to workspace $wsHax, mode "default"
  bindsym Shift+e move container to workspace $wsEmail, mode "default"
  bindsym Shift+n move container to workspace $wsNotes, mode "default"

  # move to workspace and follow that window
  bindsym d move container to workspace $wsDev; workspace $wsDev; mode "default"
  bindsym w move container to workspace $wsWeb; workspace $wsWeb; mode "default"
  bindsym s move container to workspace $wsShare; workspace $wsShare; mode "default"
  bindsym v move container to workspace $wsVibes; workspace $wsVibes; mode "default"
  bindsym m move container to workspace $wsMessages; workspace $wsMessages; mode "default"
  bindsym t move container to workspace $wsTasks; workspace $wsTasks; mode "default"
  bindsym u move container to workspace $wsUCI; workspace $wsUCI; mode "default"
  bindsym a move container to workspace $wsApp; workspace $wsApp; mode "default"
  bindsym i move container to workspace $wsID; workspace $wsID; mode "default"
  bindsym h move container to workspace $wsHax; workspace $wsHax; mode "default"
  bindsym e move container to workspace $wsEmail; workspace $wsEmail; mode "default"
  bindsym n move container to workspace $wsNotes; workspace $wsNotes; mode "default"

  # exit system mode: "Enter" or "Escape"
  bindsym Return mode "default"
  bindsym Escape mode "default"
}

# -------------------------------------------------- MISCELLANEOUS KEYBINDS
# Focus follows the mouse!
focus_follows_mouse yes
mouse_warping none
# When launching a new app, focus should go to it
focus_on_window_activation focus
#i3help start a terminal
bindsym $mod+t exec kitty
# kill focused window
bindsym $mod+c kill
#i3help Rofi launcher
bindsym $mod+slash exec rofi -show drun -icon-theme "Papirus" -show-icons
#i3help Rofi open windows
bindsym $alt+Tab exec rofi -show window -icon-theme "Papirus" -show-icons
# Rofi run program
bindsym $mod+ctrl+slash exec rofi -show run
#i3help Emoji picker
bindsym $mod+ctrl+e exec splatmoji copy
# Screenshot
bindsym Print exec flameshot gui
bindsym $mod+Print exec flameshot screen --clipboard
bindsym $mod+Ctrl+Print exec flameshot full --clipboard

# -------------------------------------------------- RESIZE MODE
mode "resize" {
  # These bindings trigger as soon as you enter the resize mode

  #i3help h shrinks width
  bindsym $left resize shrink width 5 px or 5 ppt
  #i3help j grows height
  bindsym $down resize grow height 5 px or 5 ppt
  #i3help k grows height
  bindsym $up resize shrink height 5 px or 5 ppt
  #i3help right grows width
  bindsym $right resize grow width 5 px or 5 ppt

  #i3help leave resize mode
  bindsym Return mode "default"
  #i3help leave resize mode
  bindsym Escape mode "default"
}

#i3help enter resize mode
bindsym $mod+r mode "resize"

# -------------------------------------------------- WINDOW COLORS
# property name, border, background, text, indicator
client.focused          $borderFocused $bgFocused $textFocused $indicatorFocused $borderFocused
client.unfocused        $borderUnfocused $bgUnfocused $textUnfocused $bgUnfocused $borderUnfocused
client.focused_inactive $borderUnfocused $bgUnfocused $textUnfocused $bgUnfocused $borderUnfocused
client.urgent           $borderUrgent $bgUrgent $textUrgent $textUrgent $borderUrgent
client.placeholder      $borderUnfocused $bgUnfocused $textUnfocused $barSeparator $borderUnfocused
client.background       $bgUnfocused

#i3 window colors
default_border pixel 2
default_floating_border pixel 4

# -------------------------------------------------- I3 BAR
bar {
  status_command i3status -c ~/.config/i3/i3status.conf
  font pango:Iosevka Nerd Font Medium 12
  position top
  strip_workspace_numbers yes
  bindsym button_4 nop
  bindsym button_5 nop
  colors {
    background $bgFocused
    statusline $textFocused
    separator $barSeparator
    # Workspace indicator border           background   text
    focused_workspace     $bgFocused       $bgFocused   $borderFocused
    active_workspace      $borderUnfocused $bgUnfocused $textInactiveWorkspace
    inactive_workspace    $borderUnfocused $bgUnfocused $textUnfocused
    urgent_workspace      $borderUrgent    $bgUnfocused $textUrgent
  }
}

# -------------------------------------------------- APP SHORTCUTS
set $openSomething "open:"
bindsym $mod+o mode $openSomething
mode $openSomething {
  bindsym b exec vieb, mode "default"
  bindsym Shift+f exec /opt/firefox-dev/firefox, mode "default"
  bindsym f exec thunar, mode "default"
  bindsym o exec obs, mode "default"
  bindsym v exec spotify, mode "default"
  bindsym s exec slack, mode "default"
  bindsym d exec discord, mode "default"
  bindsym t workspace $wsTasks, exec alacritty --class "tasks", mode "default"
  bindsym c exec galculator, mode "default"
  bindsym n exec /home/smithbm/AppImages/./Obsidian.AppImage, mode "default"

  # iD tech pulse + ultipro
  bindsym i workspace $wsID; exec firefox "https://ew43.ultipro.com/Login.aspx" "https://admin.idtech.com"; mode "default"
  # localhost 3000 for development
  bindsym l workspace $wsApp; exec /opt/firefox-dev/firefox --new-window "http://localhost:3000" --devtools; mode "default"
  bindsym u workspace $wsShare; exec firefox --new-window "https://uci.zoom.us/join"; exec alacritty --class "floating_alacritty" --command nvim ~/Documents/uci-meetings.md; mode "default"

  # Flatpak apps
  bindsym p exec flatpak run com.getpostman.Postman, mode "default"
  bindsym Shift+p exec flatpak run com.jetbrains.PyCharm-Community, mode "default"
  bindsym z exec flatpak run us.zoom.Zoom, mode "default"

  # Rofi run
  bindsym r exec rofi -show run -icon-them "Papirus" -show-icons, mode "default"

  # exit system mode: "Enter" or "Escape"
  bindsym Return mode "default"
  bindsym Escape mode "default"
}

bindsym $mod+b exec firefox

# -------------------------------------------------- SCRATCHPAD

# -------------------------------------------------- DEFAULT WORKSPACES
# Spotify is annoying and doesn't work with regular "assign"
for_window [class="Spotify"] move to workspace $wsVibes
assign [class="ncspot"] $wsVibes
assign [class="Slack"] $wsMessages 
assign [class="discord"] $wsMessages 
assign [class="jetbrains-pycharm-ce"] $wsShare
assign [class="Postman"] $wsHax
assign [class="Geary"] $wsEmail
assign [class="obsidian"] $wsNotes

# -------------------------------------------------- APP EXCEPTIONS
for_window [class="zoom"] floating enable
for_window [class="Alacritty" instance="^tasks$"] move to workspace $wsTasks
for_window [class="Galculator"] floating enable

# -------------------------------------------------- SCRATCHPADS
# terminal scratchpad
bindsym $mod+ctrl+t [class="Alacritty" instance="^scratchpad$"] scratchpad show; [class="Alacritty" instance="^scratchpad$"] move position center
for_window [class="Alacritty" instance="^scratchpad$"] floating enable
for_window [class="Alacritty" instance="^scratchpad$"] resize set 800 600
for_window [class="Alacritty" instance="^scratchpad$"] move scratchpad
# obs scratchpad
bindsym $mod+ctrl+o [class="^obs$"] scratchpad show; [class="^obs$"] move position center
for_window [class="^obs$"] floating enable
for_window [class="^obs$"] resize set 1600 900
for_window [class="^obs$"] move scratchpad

# -------------------------------------------------- AUTOSTART
exec ~/dotfiles/config/displays.sh
exec picom
exec nitrogen --restore
exec xsetroot -cursor_name left_ptr
exec dunst
exec flameshot
exec pactl exit

# start up scratchpad instances
exec --no-startup-id alacritty --class "scratchpad"

# programs to use on startup
# exec --no-startup-id i3-msg workspace $wsWeb; exec firefox

# exec --no-startup-id i3-msg workspace $wsVibes; exec spotify
# exec --no-startup-id i3-msg workspace $wsDev; exec alacritty
# exec --no-startup-id i3-msg workspace $wsWeb; exec firefox
